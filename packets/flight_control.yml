---
node: 'Flight Control'

podSources:
  # FCU packet types are in here.
  - ./FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/NETWORKING/fcu_core__net__packet_types.h
  # 0x1000 Accel
  - FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/ACCELEROMETERS/fcu__accel__ethernet.c
  # 0x1100 Laser Opto
  - FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/LASER_OPTO/fcu__laser_opto__ethernet.c
  # 0x1200 Laser Distance
  - FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/LASER_DISTANCE/fcu__laser_distance__ethernet.c
  # 0x1300 Laser Contrast
  - FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/LASER_CONTRAST/fcu__laser_cont__ethernet.c
  # 0x1400 Brake
  - FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/BRAKES/fcu__brakes__ethernet.c
  # 0x1500 Throttle
  - FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/THROTTLES/fcu__throttles__ethernet.c

packets:
  # 0x1000 Accel
  - packetName: 'Accel Cal Full'
    prefix: 'Accel'
    packetType: 0x1001
    parameters:
      - name: 'Flags'
        type: 'uint32'
        beginLoop: true
      - name: 'X Raw'
        type: 'int16'
      - name: 'Y Raw'
        type: 'int16'
      - name: 'Z Raw'
        type: 'int16'
        endLoop: true

  - packetName: 'Accel Data Full'
    prefix: 'Accel'
    packetType: 0x1003
    parameters:
      - name: 'Flags'
        type: 'uint32'
        beginLoop: true
      - name: 'X Raw'
        type: 'int16'
      - name: 'Y Raw'
        type: 'int16'
      - name: 'Z Raw'
        type: 'int16'
      - name: 'X Gs'
        type: 'float32'
      - name: 'Y Gs'
        type: 'float32'
      - name: 'Z Gs'
        type: 'float32'
      - name: 'Pitch'
        type: 'float32'
      - name: 'Roll'
        type: 'float32'
      - name: 'Current Accel'
        type: 'int32'
      - name: 'Current Velocity'
        type: 'int32'
      - name: 'Previous Velocity'
        type: 'int32'
      - name: 'Current Displacement'
        type: 'int32'
      - name: 'Previous Displacement'
        type: 'int32'
        endLoop: true

  # 0x1100 Laser Opto
  - packetName: 'Laser Opto Sensor'
    prefix: 'LaserOpto'
    packetType: 0x1101
    parameters:
      - name: 'Fault Flags'
        type: 'uint32'
      - name: 'Spare'
        type: 'uint32'
  
      - name: 'Fault Flags'
        type: 'uint32'
        beginLoop: true
      - name: 'Laser error packet count'
        type: 'uint32'
      - name: 'First byte wrong'
        type: 'uint32'
      - name: 'Raw distance'
        type: 'float32'
      - name: 'Filtered value'
        type: 'float32'
      - name: 'Spare'
        type: 'uint32'
        endLoop: true

  # 0x1200 Laser Distance
  - packetName: 'Forward Laser Distance Sensor'
    prefix: 'ForwardLaser'
    packetType: 0x1201
    parameters:
      - name: 'Fault Flags'
        type: 'uint32'
      # TODO: Avionics, are you drunk? (read other comments below this for context)
      # BEGIN QUESTIONABLE VARIABLES
      # sFCU.sLaserDist.s32Distance_mm
      - name: 'Spare 0'
        type: 'int32'
      # sFCU.sLaserDist.s32PrevDistance_mm
      - name: 'Spare 1'
        type: 'int32'
      # sFCU.sLaserDist.s32Velocity_mms
      - name: 'Spare 2'
        type: 'int32'
      # sFCU.sLaserDist.s32PrevVelocity_mms
      - name: 'Distance Raw'
        type: 'int32'
      # sFCU.sLaserDist.s32Accel_mmss
      - name: 'Distance Filtered'
        type: 'int32'
      # sFCU.sLaserDist.s32PrevAccel_mmss
      - name: 'Spare 3'
        type: 'int32'
      # END QUESTIONABLE VARIABLES 
      - name: 'Binary Distance'
        type: 'uint32'
      - name: 'Missed Start'
        type: 'uint32'
      - name: 'Bad Distance'
        type: 'uint32'
      - name: 'Error Code'
        type: 'uint32'

  # 0x1300 Laser Contrast
  - packetName: 'Laser Contrast 0'
    prefix: 'LaserContrast0'
    packetType: 0x1301
    parameters:
      - name: 'System Fault Flags'
        type: 'uint32'
      - name: 'Spare 1'
        type: 'uint32'
      - name: 'Spare 2'
        type: 'uint32'
      - name: 'Spare 3'
        type: 'uint32'
      - name: 'Spare 4'
        type: 'uint32'

      - name: 'Laser Fault Flags'
        type: 'uint32'

      - name: 'Rising Count'
        type: 'uint16'
      - name: 'Falling Count'
        type: 'uint16'
      - name: 'Max Stripes'
        type: 'uint16'

      # 55 stripes
      - name: 'Rise_00'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_01'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_02'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_03'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_04'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_05'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_06'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_07'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_08'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_09'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_10'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_11'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_12'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_13'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_14'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_15'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_16'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_17'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_18'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_19'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_20'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_21'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_22'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_23'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_24'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_25'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_26'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_27'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_28'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_29'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_30'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_31'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_32'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_33'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_34'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_35'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_36'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_37'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_38'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_39'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_40'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_41'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_42'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_43'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_44'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_45'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_46'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_47'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_48'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_49'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_50'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_51'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_52'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_53'
        type: 'uint64'
        units: 'ns'
      - name: 'Rise_54'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_00'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_01'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_02'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_03'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_04'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_05'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_06'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_07'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_08'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_09'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_10'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_11'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_12'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_13'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_14'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_15'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_16'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_17'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_18'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_19'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_20'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_21'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_22'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_23'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_24'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_25'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_26'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_27'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_28'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_29'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_30'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_31'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_32'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_33'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_34'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_35'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_36'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_37'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_38'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_39'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_40'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_41'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_42'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_43'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_44'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_45'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_46'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_47'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_48'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_49'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_50'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_51'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_52'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_53'
        type: 'uint64'
        units: 'ns'
      - name: 'Fall_54'
        type: 'uint64'
        units: 'ns'

  # 0x1400 Brake
  - packetName: 'Brake Data'
    prefix: 'Brake'
    packetType: 0x1402
    parameters:
      - name: 'Fault Flags'
        type: 'uint32'
        units: 'a'
        beginLoop: true

      - name: 'I Beam mm Target'
        units: 'mm'
        type: 'float32'
      - name: 'Lead Screw mm Target'
        units: 'mm'
        type: 'float32'
      - name: 'Lead Screw um Target'
        units: 'um'
        type: 'uint32'

      - name: 'I Beam mm Current'
        units: 'mm'
        type: 'float32'
      - name: 'Lead Screw mm Current'
        units: 'mm'
        type: 'float32'
      - name: 'MLP Current'
        units: 'mm'
        type: 'float32'

      # Spare packet slots
      - name: 'Spare 1'
        type: 'uint32'
      - name: 'Spare 2'
        type: 'uint32'

      # TODO: WTF? fcu__brakes__ethernet.c:146
      - name: 'Limit Extend'
        type: 'uint8'
      - name: 'Limit Retract'
        type: 'uint8'
      - name: 'Limit Extend Edge'
        type: 'uint8'
      - name: 'Limit Retract Edge'
        type: 'uint8'
      - name: 'SW Error'
        type: 'uint8'

      - name: 'ADC Sample'
        type: 'uint16'
      - name: 'ADC Zero'
        type: 'uint16'
      - name: 'ADC Minus Zero'
        type: 'int32'
      - name: 'System Span'
        type: 'float32'
      - name: 'Brake Position'
        type: 'float32'

      - name: 'Linear Velocity'
        type: 'int32'
      - name: 'Linear Acceleration'
        type: 'int32'
      - name: 'Current Position'
        type: 'int32'
        endLoop: true

      - name: 'State'
        type: 'uint8'
      - name: 'Calibration State'
        type: 'uint8'

  - packetName: 'Motor Parameters'
    prefix: 'Motor'
    packetType: 0x1406
    parameters:
      - name: 'Microstep Resolution'
        type: 'uint32'
        beginLoop: true
      - name: 'Max Acceleration'
        type: 'int32'
      - name: 'Microns per Revolution'
        type: 'int32'
      - name: 'Steps per Revolution'
        type: 'uint32'
      - name: 'Max Angular Velocity'
        type: 'int32'
        endLoop: true
      # TODO: What's the type of this? FIRMWARE/PROJECT_CODE/LCCM655__RLOOP__FCU_CORE/BRAKES/fcu__brakes__ethernet.c:112
      - name: 'Unknown Timer'
        type: 'int8'

  # 0x1500 Throttle
  - packetName: 'Throttle Parameters'
    prefix: 'Throttle'
    packetType: 0x1503
    parameters:
      - name: 'Fault Flags'
        type: 'uint32'
      - name: 'AMC Fault Flags'
        type: 'uint32'

      - name: 'Requested RPM'
        type: 'uint16'
        beginLoop: true
        endLoop: true
      - name: 'Current RPM'
        type: 'uint16'
        beginLoop: true
        endLoop: true
      - name: 'ASI RPM'
        type: 'uint16'
        beginLoop: true
        endLoop: true

      - name: 'State'
        type: 'uint8'
      - name: 'Current Index'
        type: 'uint8'
      - name: 'AMC State'
        type: 'uint8'

  # TODO: 0x1901 Auto Sequence could not be found in pod code.
  - packetName: 'Auto-sequence test'
    prefix: 'Auto-test'
    packetType: 0x1901
    parameters:
      - name: 'State'
        type: 'uint32'
      - name: 'Status'
        type: 'uint8'
